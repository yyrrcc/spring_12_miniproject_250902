<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.mycompany.mini.dao.ReservationDao">

	<!-- 예약하기 -->
	<insert id="resWrite">
		INSERT INTO minireservation (resid, memberid, resdate, restime, persons) VALUES (MINIRES_SEQ.nextval, #{memberId}, #{resDate}, #{resTime}, #{persons})
	</insert>
	
	<!-- 모든 예약 목록 -->
	<resultMap type="com.mycompany.mini.dto.ReservationDto" id="resWithMember">
		<id property="resId" column="resId"/>
		<result property="memberId" column="memberId"/>
		<result property="resDate" column="resDate"/>
		<result property="resTime" column="resTime"/>
		<result property="persons" column="persons"/>
		<result property="Timestamp" column="regDate"/>
			<association property="memberDto" javaType="com.mycompany.mini.dto.MemberDto">
				<id property="memberId" column="memberId"/>
				<result property="password" column="password"/>
				<result property="name" column="name"/>
				<result property="phone" column="phone"/>
				<result property="email" column="email"/>
				<result property="regDate" column="regDate"/>			
			</association>
	</resultMap>
	<select id="resList" resultMap="resWithMember">
		SELECT res.resid, res.memberid, m.name, res.resdate, res.restime, res.persons FROM minireservation res
		INNER JOIN minimember m
		ON res.memberid = m.memberid
	</select>

</mapper>
